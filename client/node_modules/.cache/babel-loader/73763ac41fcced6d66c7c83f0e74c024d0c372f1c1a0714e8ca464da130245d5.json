{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{io}from'socket.io-client';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const SocketContext=/*#__PURE__*/createContext();export const useSocket=()=>{const context=useContext(SocketContext);if(!context){throw new Error('useSocket must be used within a SocketProvider');}return context;};export const SocketProvider=_ref=>{let{children}=_ref;const[socket,setSocket]=useState(null);const[connected,setConnected]=useState(false);const{user}=useAuth();useEffect(()=>{if(user){// Initialize socket connection\nconst socketInstance=io(process.env.REACT_APP_API_URL||'http://localhost:5000',{withCredentials:true,transports:['websocket','polling']});socketInstance.on('connect',()=>{console.log('Socket connected:',socketInstance.id);setConnected(true);// Join user-specific room for targeted notifications\nsocketInstance.emit('join-user-room',user.id);});socketInstance.on('disconnect',()=>{console.log('Socket disconnected');setConnected(false);});socketInstance.on('connect_error',error=>{console.error('Socket connection error:',error);setConnected(false);});setSocket(socketInstance);return()=>{socketInstance.disconnect();};}else{// Disconnect socket when user logs out\nif(socket){socket.disconnect();setSocket(null);setConnected(false);}}},[user]);const value={socket,connected};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:value,children:children});};export default SocketContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","io","useAuth","jsx","_jsx","SocketContext","useSocket","context","Error","SocketProvider","_ref","children","socket","setSocket","connected","setConnected","user","socketInstance","process","env","REACT_APP_API_URL","withCredentials","transports","on","console","log","id","emit","error","disconnect","value","Provider"],"sources":["C:/Users/hp/Desktop/ADMINCLIENTPANELDEMO/perfectclone/client/src/contexts/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { io } from 'socket.io-client';\nimport { useAuth } from './AuthContext';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => {\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocket must be used within a SocketProvider');\n  }\n  return context;\n};\n\nexport const SocketProvider = ({ children }) => {\n  const [socket, setSocket] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const { user } = useAuth();\n\n  useEffect(() => {\n    if (user) {\n      // Initialize socket connection\n      const socketInstance = io(process.env.REACT_APP_API_URL || 'http://localhost:5000', {\n        withCredentials: true,\n        transports: ['websocket', 'polling']\n      });\n\n      socketInstance.on('connect', () => {\n        console.log('Socket connected:', socketInstance.id);\n        setConnected(true);\n\n        // Join user-specific room for targeted notifications\n        socketInstance.emit('join-user-room', user.id);\n      });\n\n      socketInstance.on('disconnect', () => {\n        console.log('Socket disconnected');\n        setConnected(false);\n      });\n\n      socketInstance.on('connect_error', (error) => {\n        console.error('Socket connection error:', error);\n        setConnected(false);\n      });\n\n      setSocket(socketInstance);\n\n      return () => {\n        socketInstance.disconnect();\n      };\n    } else {\n      // Disconnect socket when user logs out\n      if (socket) {\n        socket.disconnect();\n        setSocket(null);\n        setConnected(false);\n      }\n    }\n  }, [user]);\n\n  const value = {\n    socket,\n    connected\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n\nexport default SocketContext;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC7E,OAASC,EAAE,KAAQ,kBAAkB,CACrC,OAASC,OAAO,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAExC,KAAM,CAAAC,aAAa,cAAGR,aAAa,CAAC,CAAC,CAErC,MAAO,MAAM,CAAAS,SAAS,CAAGA,CAAA,GAAM,CAC7B,KAAM,CAAAC,OAAO,CAAGT,UAAU,CAACO,aAAa,CAAC,CACzC,GAAI,CAACE,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAC,KAAK,CAAC,gDAAgD,CAAC,CACnE,CACA,MAAO,CAAAD,OAAO,CAChB,CAAC,CAED,MAAO,MAAM,CAAAE,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACzC,KAAM,CAACE,MAAM,CAAEC,SAAS,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACc,SAAS,CAAEC,YAAY,CAAC,CAAGf,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAAEgB,IAAK,CAAC,CAAGd,OAAO,CAAC,CAAC,CAE1BH,SAAS,CAAC,IAAM,CACd,GAAIiB,IAAI,CAAE,CACR;AACA,KAAM,CAAAC,cAAc,CAAGhB,EAAE,CAACiB,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,uBAAuB,CAAE,CAClFC,eAAe,CAAE,IAAI,CACrBC,UAAU,CAAE,CAAC,WAAW,CAAE,SAAS,CACrC,CAAC,CAAC,CAEFL,cAAc,CAACM,EAAE,CAAC,SAAS,CAAE,IAAM,CACjCC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAER,cAAc,CAACS,EAAE,CAAC,CACnDX,YAAY,CAAC,IAAI,CAAC,CAElB;AACAE,cAAc,CAACU,IAAI,CAAC,gBAAgB,CAAEX,IAAI,CAACU,EAAE,CAAC,CAChD,CAAC,CAAC,CAEFT,cAAc,CAACM,EAAE,CAAC,YAAY,CAAE,IAAM,CACpCC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC,CAClCV,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CAEFE,cAAc,CAACM,EAAE,CAAC,eAAe,CAAGK,KAAK,EAAK,CAC5CJ,OAAO,CAACI,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDb,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CAEFF,SAAS,CAACI,cAAc,CAAC,CAEzB,MAAO,IAAM,CACXA,cAAc,CAACY,UAAU,CAAC,CAAC,CAC7B,CAAC,CACH,CAAC,IAAM,CACL;AACA,GAAIjB,MAAM,CAAE,CACVA,MAAM,CAACiB,UAAU,CAAC,CAAC,CACnBhB,SAAS,CAAC,IAAI,CAAC,CACfE,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CACF,CAAC,CAAE,CAACC,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAc,KAAK,CAAG,CACZlB,MAAM,CACNE,SACF,CAAC,CAED,mBACEV,IAAA,CAACC,aAAa,CAAC0B,QAAQ,EAACD,KAAK,CAAEA,KAAM,CAAAnB,QAAA,CAClCA,QAAQ,CACa,CAAC,CAE7B,CAAC,CAED,cAAe,CAAAN,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}